var sortable = function () { "use strict"; function e(e, t, n) { if (void 0 === n) return e && e.h5s && e.h5s.data && e.h5s.data[t]; e.h5s = e.h5s || {}, e.h5s.data = e.h5s.data || {}, e.h5s.data[t] = n } var t = function (e, t) { if (!(e instanceof NodeList || e instanceof HTMLCollection || e instanceof Array)) throw new Error("You must provide a nodeList/HTMLCollection/Array of elements to be filtered."); return "string" != typeof t ? Array.from(e) : Array.from(e).filter(function (e) { return 1 === e.nodeType && e.matches(t) }) }, n = new Map, r = function () { function e() { this._config = new Map, this._placeholder = void 0, this._data = new Map } return Object.defineProperty(e.prototype, "config", { get: function () { var e = {}; return this._config.forEach(function (t, n) { e[n] = t }), e }, set: function (e) { if ("object" != typeof e) throw new Error("You must provide a valid configuration object to the config setter."); var t = Object.assign({}, e); this._config = new Map(Object.entries(t)) }, enumerable: !1, configurable: !0 }), e.prototype.setConfig = function (e, t) { if (!this._config.has(e)) throw new Error("Trying to set invalid configuration item: " + e); this._config.set(e, t) }, e.prototype.getConfig = function (e) { if (!this._config.has(e)) throw new Error("Invalid configuration item requested: " + e); return this._config.get(e) }, Object.defineProperty(e.prototype, "placeholder", { get: function () { return this._placeholder }, set: function (e) { if (!(e instanceof HTMLElement) && null !== e) throw new Error("A placeholder must be an html element or null."); this._placeholder = e }, enumerable: !1, configurable: !0 }), e.prototype.setData = function (e, t) { if ("string" != typeof e) throw new Error("The key must be a string."); this._data.set(e, t) }, e.prototype.getData = function (e) { if ("string" != typeof e) throw new Error("The key must be a string."); return this._data.get(e) }, e.prototype.deleteData = function (e) { if ("string" != typeof e) throw new Error("The key must be a string."); return this._data.delete(e) }, e }(), o = function (e) { if (!(e instanceof HTMLElement)) throw new Error("Please provide a sortable to the store function."); return n.has(e) || n.set(e, new r), n.get(e) }; function a(e, t, n) { if (e instanceof Array) for (var r = 0; r < e.length; ++r)a(e[r], t, n); else e.addEventListener(t, n), o(e).setData("event" + t, n) } function i(e, t) { if (e instanceof Array) for (var n = 0; n < e.length; ++n)i(e[n], t); else e.removeEventListener(t, o(e).getData("event" + t)), o(e).deleteData("event" + t) } function l(e, t, n) { if (e instanceof Array) for (var r = 0; r < e.length; ++r)l(e[r], t, n); else e.setAttribute(t, n) } function s(e, t) { if (e instanceof Array) for (var n = 0; n < e.length; ++n)s(e[n], t); else e.removeAttribute(t) } var c = function (e) { if (!e.parentElement || 0 === e.getClientRects().length) throw new Error("target element must be part of the dom"); var t = e.getClientRects()[0]; return { left: t.left + window.pageXOffset, right: t.right + window.pageXOffset, top: t.top + window.pageYOffset, bottom: t.bottom + window.pageYOffset } }, d = function (e, t) { var n; return void 0 === t && (t = 0), function () { for (var r = [], o = 0; o < arguments.length; o++)r[o] = arguments[o]; clearTimeout(n), n = setTimeout(function () { e.apply(void 0, r) }, t) } }, f = function (e, t) { if (!(e instanceof HTMLElement && (t instanceof NodeList || t instanceof HTMLCollection || t instanceof Array))) throw new Error("You must provide an element and a list of elements."); return Array.from(t).indexOf(e) }, u = function (e) { if (!(e instanceof HTMLElement)) throw new Error("Element is not a node element."); return null !== e.parentNode }, p = function (e, t, n) { if (!(e instanceof HTMLElement && e.parentElement instanceof HTMLElement)) throw new Error("target and element must be a node"); e.parentElement.insertBefore(t, "before" === n ? e : e.nextElementSibling) }, m = function (e, t) { return p(e, t, "before") }, g = function (e, t) { return p(e, t, "after") }, h = function (n, r, o) { if (void 0 === r && (r = function (e, t) { return e }), void 0 === o && (o = function (e) { return e }), !(n instanceof HTMLElement) || !0 == !n.isSortable) throw new Error("You need to provide a sortableContainer to be serialized."); if ("function" != typeof r || "function" != typeof o) throw new Error("You need to provide a valid serializer for items and the container."); var a = e(n, "opts").items, i = t(n.children, a), l = i.map(function (e) { return { parent: n, node: e, html: e.outerHTML, index: f(e, i) } }); return { container: o({ node: n, itemCount: l.length }), items: l.map(function (e) { return r(e, n) }) } }, v = function (e, t, n) { var r; if (void 0 === n && (n = "sortable-placeholder"), !(e instanceof HTMLElement)) throw new Error("You must provide a valid element as a sortable."); if (!(t instanceof HTMLElement) && void 0 !== t) throw new Error("You must provide a valid element as a placeholder or set ot to undefined."); return void 0 === t && (["UL", "OL"].includes(e.tagName) ? t = document.createElement("li") : ["TABLE", "TBODY"].includes(e.tagName) ? (t = document.createElement("tr")).innerHTML = '<td colspan="100"></td>' : t = document.createElement("div")), "string" == typeof n && (r = t.classList).add.apply(r, n.split(" ")), t }, y = function (e) { if (!(e instanceof HTMLElement)) throw new Error("You must provide a valid dom element"); var t = window.getComputedStyle(e); return "border-box" === t.getPropertyValue("box-sizing") ? parseInt(t.getPropertyValue("height"), 10) : ["height", "padding-top", "padding-bottom"].map(function (e) { var n = parseInt(t.getPropertyValue(e), 10); return isNaN(n) ? 0 : n }).reduce(function (e, t) { return e + t }) }, E = function (e) { if (!(e instanceof HTMLElement)) throw new Error("You must provide a valid dom element"); var t = window.getComputedStyle(e); return ["width", "padding-left", "padding-right"].map(function (e) { var n = parseInt(t.getPropertyValue(e), 10); return isNaN(n) ? 0 : n }).reduce(function (e, t) { return e + t }) }, w = function (e, t) { if (!(e instanceof Array)) throw new Error("You must provide a Array of HTMLElements to be filtered."); return "string" != typeof t ? e : e.filter(function (e) { return e.querySelector(t) instanceof HTMLElement || e.shadowRoot && e.shadowRoot.querySelector(t) instanceof HTMLElement }).map(function (e) { return e.querySelector(t) || e.shadowRoot && e.shadowRoot.querySelector(t) }) }, b = function (e) { return e.composedPath && e.composedPath()[0] || e.target }, T = function (e, t, n) { return { element: e, posX: n.pageX - t.left, posY: n.pageY - t.top } }, C = function (e, t, n) { if (!(e instanceof Event)) throw new Error("setDragImage requires a DragEvent as the first argument."); if (!(t instanceof HTMLElement)) throw new Error("setDragImage requires the dragged element as the second argument."); if (n || (n = T), e.dataTransfer && e.dataTransfer.setDragImage) { var r = n(t, c(t), e); if (!(r.element instanceof HTMLElement) || "number" != typeof r.posX || "number" != typeof r.posY) throw new Error("The customDragImage function you provided must return and object with the properties element[string], posX[integer], posY[integer]."); e.dataTransfer.effectAllowed = "copyMove", e.dataTransfer.setData("text/plain", b(e).id), e.dataTransfer.setDragImage(r.element, r.posX, r.posY) } }, L = function (e, t) { if (!0 === e.isSortable) { var n = o(e).getConfig("acceptFrom"); if (null !== n && !1 !== n && "string" != typeof n) throw new Error('HTML5Sortable: Wrong argument, "acceptFrom" must be "null", "false", or a valid selector string.'); if (null !== n) return !1 !== n && n.split(",").filter(function (e) { return e.length > 0 && t.matches(e) }).length > 0; if (e === t) return !0; if (void 0 !== o(e).getConfig("connectWith") && null !== o(e).getConfig("connectWith")) return o(e).getConfig("connectWith") === o(t).getConfig("connectWith") } return !1 }, x = { items: null, connectWith: null, disableIEFix: null, acceptFrom: null, copy: !1, placeholder: null, placeholderClass: "sortable-placeholder", draggingClass: "sortable-dragging", hoverClass: !1, dropTargetContainerClass: !1, debounce: 0, throttleTime: 100, maxItems: 0, itemSerializer: void 0, containerSerializer: void 0, customDragImage: null, orientation: "vertical" }; var M, D, H, I, A, S, Y, _, O, P = function (e, n) { if ("string" == typeof o(e).getConfig("hoverClass")) { var r = o(e).getConfig("hoverClass").split(" "); !0 === n ? (a(e, "mousemove", function (e, t) { var n = this; if (void 0 === t && (t = 250), "function" != typeof e) throw new Error("You must provide a function as the first argument for throttle."); if ("number" != typeof t) throw new Error("You must provide a number as the second argument for throttle."); var r = null; return function () { for (var o = [], a = 0; a < arguments.length; a++)o[a] = arguments[a]; var i = Date.now(); (null === r || i - r >= t) && (r = i, e.apply(n, o)) } }(function (n) { 0 === n.buttons && t(e.children, o(e).getConfig("items")).forEach(function (e) { var t, o; e !== n.target ? (t = e.classList).remove.apply(t, r) : (o = e.classList).add.apply(o, r) }) }, o(e).getConfig("throttleTime"))), a(e, "mouseleave", function () { t(e.children, o(e).getConfig("items")).forEach(function (e) { var t; (t = e.classList).remove.apply(t, r) }) })) : (i(e, "mousemove"), i(e, "mouseleave")) } }, z = function (e) { i(e, "dragstart"), i(e, "dragend"), i(e, "dragover"), i(e, "dragenter"), i(e, "drop"), i(e, "mouseenter"), i(e, "mouseleave") }, N = function (e, t) { e && i(e, "dragleave"), t && t !== e && i(t, "dragleave") }, W = function (e, t) { var n = e; return !0 === o(t).getConfig("copy") && (l(n = e.cloneNode(!0), "aria-copied", "true"), e.parentElement.appendChild(n), n.style.display = "none", n.oldDisplay = e.style.display), n }, j = function (e) { var t; (t = e).h5s && delete t.h5s.data, s(e, "aria-dropeffect") }, F = function (e) { s(e, "aria-grabbed"), s(e, "aria-copied"), s(e, "draggable"), s(e, "role") }; function q(e, t) { if (t.composedPath) return t.composedPath().find(function (e) { return e.isSortable }); for (; !0 !== e.isSortable;)e = e.parentElement; return e } function R(n, r) { var o = e(n, "opts"), a = t(n.children, o.items).filter(function (e) { return e.contains(r) || e.shadowRoot && e.shadowRoot.contains(r) }); return a.length > 0 ? a[0] : r } var X = function (n) { var r = e(n, "opts"), o = t(n.children, r.items), i = w(o, r.handle); (l(n, "aria-dropeffect", "move"), e(n, "_disabled", "false"), l(i, "draggable", "true"), P(n, !0), !1 === r.disableIEFix) && ("function" == typeof (document || window.document).createElement("span").dragDrop && a(i, "mousedown", function () { if (-1 !== o.indexOf(this)) this.dragDrop(); else { for (var e = this.parentElement; -1 === o.indexOf(e);)e = e.parentElement; e.dragDrop() } })) }, B = function (n) { var r = e(n, "opts"), o = t(n.children, r.items), a = w(o, r.handle); e(n, "_disabled", "false"), z(o), N(I, _), i(a, "mousedown"), i(n, "dragover"), i(n, "dragenter"), i(n, "drop") }; function k(r, i) { var s = String(i); return i = i || {}, "string" == typeof r && (r = document.querySelectorAll(r)), r instanceof HTMLElement && (r = [r]), r = Array.prototype.slice.call(r), /serialize/.test(s) ? r.map(function (t) { var n = e(t, "opts"); return h(t, n.itemSerializer, n.containerSerializer) }) : (r.forEach(function (r) { if (/enable|disable|destroy/.test(s)) return k[s](r);["connectWith", "disableIEFix"].forEach(function (e) { Object.prototype.hasOwnProperty.call(i, e) && null !== i[e] && console.warn('HTML5Sortable: You are using the deprecated configuration "' + e + '". This will be removed in an upcoming version, make sure to migrate to the new options when updating.') }), i = Object.assign({}, x, o(r).config, i), o(r).config = i, e(r, "opts", i), r.isSortable = !0, B(r); var p, h = t(r.children, i.items); if (null !== i.placeholder && void 0 !== i.placeholder) { var w = document.createElement(r.tagName); i.placeholder instanceof HTMLElement ? w.appendChild(i.placeholder) : w.innerHTML = i.placeholder, p = w.children[0] } o(r).placeholder = v(r, p, i.placeholderClass), e(r, "items", i.items), i.acceptFrom ? e(r, "acceptFrom", i.acceptFrom) : i.connectWith && e(r, "connectWith", i.connectWith), X(r), l(h, "role", "option"), l(h, "aria-grabbed", "false"), a(r, "dragstart", function (e) { var n = b(e); if (!0 !== n.isSortable && (e.stopImmediatePropagation(), (!i.handle || n.matches(i.handle)) && "false" !== n.getAttribute("draggable"))) { var r = q(n, e), o = R(r, n); Y = t(r.children, i.items), A = Y.indexOf(o), S = f(o, r.children), I = r, C(e, o, i.customDragImage), D = y(o), H = E(o), o.classList.add(i.draggingClass), l(M = W(o, r), "aria-grabbed", "true"), r.dispatchEvent(new CustomEvent("sortstart", { detail: { origin: { elementIndex: S, index: A, container: I }, item: M, originalTarget: n } })) } }), a(r, "dragenter", function (n) { var l = b(n), s = q(l, n); s && s !== _ && (O = t(s.children, e(s, "items")).filter(function (e) { return e !== o(r).placeholder }), i.dropTargetContainerClass && s.classList.add(i.dropTargetContainerClass), s.dispatchEvent(new CustomEvent("sortenter", { detail: { origin: { elementIndex: S, index: A, container: I }, destination: { container: s, itemsBeforeUpdate: O }, item: M, originalTarget: l } })), a(s, "dragleave", function (e) { var t = e.relatedTarget || e.fromElement; e.currentTarget.contains(t) || (i.dropTargetContainerClass && s.classList.remove(i.dropTargetContainerClass), s.dispatchEvent(new CustomEvent("sortleave", { detail: { origin: { elementIndex: S, index: A, container: s }, item: M, originalTarget: l } }))) })), _ = s }), a(r, "dragend", function (t) { if (M) { M.classList.remove(i.draggingClass), l(M, "aria-grabbed", "false"), "true" === M.getAttribute("aria-copied") && "true" !== e(M, "dropped") && M.remove(), M.style.display = M.oldDisplay, delete M.oldDisplay; var o = Array.from(n.values()).map(function (e) { return e.placeholder }).filter(function (e) { return e instanceof HTMLElement }).filter(u)[0]; o && o.remove(), r.dispatchEvent(new CustomEvent("sortstop", { detail: { origin: { elementIndex: S, index: A, container: I }, item: M } })), _ = null, M = null, D = null, H = null } }), a(r, "drop", function (a) { if (L(r, M.parentElement)) { a.preventDefault(), a.stopPropagation(), e(M, "dropped", "true"); var l = Array.from(n.values()).map(function (e) { return e.placeholder }).filter(function (e) { return e instanceof HTMLElement }).filter(u)[0]; g(l, M), l.remove(), r.dispatchEvent(new CustomEvent("sortstop", { detail: { origin: { elementIndex: S, index: A, container: I }, item: M } })); var s = o(r).placeholder, c = t(I.children, i.items).filter(function (e) { return e !== s }), d = !0 === this.isSortable ? this : this.parentElement, p = t(d.children, e(d, "items")).filter(function (e) { return e !== s }), m = f(M, Array.from(M.parentElement.children).filter(function (e) { return e !== s })), h = f(M, p); i.dropTargetContainerClass && d.classList.remove(i.dropTargetContainerClass), S === m && I === d || r.dispatchEvent(new CustomEvent("sortupdate", { detail: { origin: { elementIndex: S, index: A, container: I, itemsBeforeUpdate: Y, items: c }, destination: { index: h, elementIndex: m, container: d, itemsBeforeUpdate: O, items: p }, item: M } })) } }); var T = d(function (e, r, a, l) { if (M) if (i.forcePlaceholderSize && (o(e).placeholder.style.height = D + "px", o(e).placeholder.style.width = H + "px"), Array.from(e.children).indexOf(r) > -1) { var s = y(r), d = E(r), u = f(o(e).placeholder, r.parentElement.children), p = f(r, r.parentElement.children); if (s > D || d > H) { var h = s - D, v = d - H, w = c(r).top, b = c(r).left; if (u < p && ("vertical" === i.orientation && l < w || "horizontal" === i.orientation && a < b)) return; if (u > p && ("vertical" === i.orientation && l > w + s - h || "horizontal" === i.orientation && a > b + d - v)) return } void 0 === M.oldDisplay && (M.oldDisplay = M.style.display), "none" !== M.style.display && (M.style.display = "none"); var T = !1; try { var C = c(r).top + r.offsetHeight / 2, L = c(r).left + r.offsetWidth / 2; T = "vertical" === i.orientation && l >= C || "horizontal" === i.orientation && a >= L } catch (e) { T = u < p } T ? g(r, o(e).placeholder) : m(r, o(e).placeholder), Array.from(n.values()).filter(function (e) { return void 0 !== e.placeholder }).forEach(function (t) { t.placeholder !== o(e).placeholder && t.placeholder.remove() }) } else { var x = Array.from(n.values()).filter(function (e) { return void 0 !== e.placeholder }).map(function (e) { return e.placeholder }); -1 !== x.indexOf(r) || e !== r || t(r.children, i.items).length || (x.forEach(function (e) { return e.remove() }), r.appendChild(o(e).placeholder)) } }, i.debounce), P = function (n) { var r = n.target, a = !0 === r.isSortable ? r : q(r, n); if (r = R(a, r), M && L(a, M.parentElement) && "true" !== e(a, "_disabled")) { var i = e(a, "opts"); parseInt(i.maxItems) && t(a.children, e(a, "items")).length >= parseInt(i.maxItems) && M.parentElement !== a || (n.preventDefault(), n.stopPropagation(), n.dataTransfer.dropEffect = !0 === o(a).getConfig("copy") ? "copy" : "move", T(a, r, n.pageX, n.pageY)) } }; a(h.concat(r), "dragover", P), a(h.concat(r), "dragenter", P) }), r) } return k.destroy = function (n) { !function (n) { var r = e(n, "opts") || {}, o = t(n.children, r.items), a = w(o, r.handle); P(n, !1), i(n, "dragover"), i(n, "dragenter"), i(n, "dragstart"), i(n, "dragend"), i(n, "drop"), j(n), i(a, "mousedown"), z(o), F(o), N(I, _), n.isSortable = !1 }(n) }, k.enable = function (e) { X(e) }, k.disable = function (n) { !function (n) { var r = e(n, "opts"), o = t(n.children, r.items), a = w(o, r.handle); l(n, "aria-dropeffect", "none"), e(n, "_disabled", "true"), l(a, "draggable", "false"), i(a, "mousedown"), P(n, !1) }(n) }, k.__testing = { data: e, removeItemEvents: z, removeItemData: F, removeSortableData: j, removeContainerEvents: N }, k }();